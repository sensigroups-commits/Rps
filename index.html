<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ÿ¢ÿ±ŸÜÿß | ÿ≥ŸÜ⁄Ø ⁄©ÿßÿ∫ÿ∞ ŸÇ€å⁄Ü€å Ÿæ€åÿ¥ÿ±ŸÅÿ™Ÿá</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary: #6366f1;
            --primary-glow: rgba(99, 102, 241, 0.5);
            --success: #10b981;
            --success-glow: rgba(16, 185, 129, 0.5);
            --gold: #fbbf24;
            --gold-glow: rgba(251, 191, 36, 0.5);
            --silver: #94a3b8;
            --silver-glow: rgba(148, 163, 184, 0.5);
            --danger: #ef4444;
        }

        [data-theme="dark"] {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            --card-bg: rgba(20, 20, 30, 0.8);
            --border-color: rgba(255, 255, 255, 0.05);
            --shadow-color: rgba(0, 0, 0, 0.5);
        }

        [data-theme="light"] {
            --bg-primary: #f0f2f5;
            --bg-secondary: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #4a4a5a;
            --card-bg: rgba(255, 255, 255, 0.7);
            --border-color: rgba(0, 0, 0, 0.05);
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Vazirmatn', 'Orbitron', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.2) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(16, 185, 129, 0.2) 0%, transparent 50%);
            animation: gradientMove 15s ease infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes gradientMove {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .container {
            position: relative;
            max-width: 500px;
            margin: 0 auto;
            padding: 12px;
            z-index: 1;
        }

        /* ========== ŸáÿØÿ± ========== */
        .header {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 30px;
            padding: 12px 20px;
            margin-bottom: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .header h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
            background: linear-gradient(135deg, var(--primary), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-buttons {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        /* ========== ÿØ⁄©ŸÖŸá ⁄©ÿ¥Ÿà€å€å ÿ™ŸÖ ========== */
        .theme-switch {
            width: 70px;
            height: 36px;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 40px;
            position: relative;
            cursor: pointer;
            overflow: hidden;
            box-shadow: 0 0 10px var(--primary-glow);
        }

        .theme-slider {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            align-items: center;
            padding: 0 4px;
        }

        .theme-knob {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, var(--primary), #818cf8);
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            z-index: 2;
        }

        .theme-knob.dark {
            transform: translateX(34px);
        }

        .theme-icon {
            position: absolute;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 10px;
            z-index: 1;
            font-size: 16px;
            color: var(--text-secondary);
            pointer-events: none;
        }

        .theme-icon span {
            filter: drop-shadow(0 0 5px gold);
            animation: iconFloat 3s ease infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-2px) rotate(10deg); }
        }

        /* ========== ÿØ⁄©ŸÖŸá ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá ========== */
        .shop-btn {
            background: linear-gradient(135deg, var(--gold), #f59e0b);
            border: none;
            border-radius: 40px;
            padding: 8px 16px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px var(--gold-glow);
            position: relative;
            overflow: hidden;
        }

        .shop-btn::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(transparent, rgba(255,255,255,0.3), transparent);
            animation: rotate 4s linear infinite;
        }

        .shop-btn span {
            position: relative;
            z-index: 2;
        }

        .shop-btn:active {
            transform: scale(0.95);
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ========== ŸÜŸà€å⁄Ø€åÿ¥ŸÜ ========== */
        .game-nav {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }

        .nav-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 30px;
            background: var(--card-bg);
            color: var(--text-primary);
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .nav-btn.active {
            background: linear-gradient(135deg, var(--primary), #818cf8);
            color: white;
            box-shadow: 0 0 20px var(--primary-glow);
        }

        /* ========== Ÿæÿ±ŸàŸÅÿß€åŸÑ ========== */
        .profile-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 30px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .profile-row {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .avatar-container {
            position: relative;
            width: 70px;
            height: 70px;
            flex-shrink: 0;
        }

        .avatar-frame {
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border-radius: 50%;
            z-index: 1;
            pointer-events: none;
        }

        .avatar-img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            color: white;
            position: relative;
            z-index: 2;
            overflow: hidden;
        }

        .avatar-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-info {
            flex: 1;
            min-width: 150px;
        }

        .profile-name {
            font-size: 18px;
            font-weight: bold;
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 4px;
        }

        .profile-stats {
            display: flex;
            gap: 12px;
            font-size: 13px;
            color: var(--text-secondary);
            flex-wrap: wrap;
        }

        .coins {
            background: linear-gradient(135deg, var(--gold), #f59e0b);
            padding: 4px 12px;
            border-radius: 30px;
            color: white;
            font-weight: bold;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-top: 8px;
        }

        /* ========== ÿ®ÿÆÿ¥‚ÄåŸáÿß ========== */
        .game-section, .shop-section {
            display: none;
        }

        .game-section.active, .shop-section.active {
            display: block;
        }

        .game-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 30px;
            padding: 20px;
            margin-bottom: 16px;
        }

        /* ========== ÿ≠ÿßŸÑÿ™ ÿ®ÿßÿ≤€å ========== */
        .mode-switch {
            display: flex;
            gap: 8px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 40px;
            padding: 4px;
            margin-bottom: 20px;
        }

        .mode-option {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 30px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-option.active {
            background: linear-gradient(135deg, var(--primary), #818cf8);
            color: white;
        }

        /* ========== VS ÿ®ÿß⁄©ÿ≥ ========== */
        .vs-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .vs-box {
            flex: 1;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            padding: 20px 10px;
            text-align: center;
            position: relative;
            animation: float 3s ease infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .vs-box h3 {
            font-size: 14px;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .choice-display {
            font-size: 48px;
            min-height: 70px;
        }

        .vs-divider {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            text-shadow: 0 0 10px var(--primary-glow);
        }

        .score-badge {
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--primary), var(--success));
            color: white;
            padding: 4px 12px;
            border-radius: 30px;
            font-size: 12px;
            font-weight: bold;
            white-space: nowrap;
        }

        .result-message {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin: 15px 0;
            background: linear-gradient(135deg, var(--primary), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s ease infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        /* ========== ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å ŸÖŸÜŸà ========== */
        .choose-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--primary), #818cf8);
            border: none;
            border-radius: 40px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 0 rgba(0, 0, 0, 0.2);
            transition: all 0.1s;
        }

        .choose-btn:active {
            transform: translateY(5px);
            box-shadow: none;
        }

        .choose-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            100% { left: 100%; }
        }

        .arrow-icon {
            transition: transform 0.3s;
        }

        /* ========== ⁄Øÿ±€åÿØ ÿßŸÜÿ™ÿÆÿßÿ® ========== */
        .choices-wrapper, .guide-wrapper {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--card-bg);
            border-radius: 30px;
            border: 1px solid var(--border-color);
            transform: scaleY(0);
            transform-origin: top;
        }

        .choices-wrapper.open, .guide-wrapper.open {
            max-height: 400px;
            opacity: 1;
            margin-top: 10px;
            transform: scaleY(1);
            overflow-y: auto;
        }

        .choices-grid, .guide-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            padding: 16px;
        }

        .choice-item, .guide-item {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            padding: 12px 4px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .choice-item:active {
            transform: scale(0.95);
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--primary), #818cf8);
        }

        .choice-emoji {
            font-size: 30px;
            filter: drop-shadow(0 0 8px var(--primary-glow));
        }

        .choice-name {
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* ========== ÿ±ÿßŸáŸÜŸÖÿß ========== */
        .guide-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .guide-header {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
        }

        .guide-details {
            display: none;
            font-size: 12px;
            padding: 8px;
            margin-top: 8px;
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
        }

        .guide-item.active .guide-details {
            display: block;
        }

        .guide-wins { color: var(--success); }
        .guide-loses { color: var(--danger); }

        /* ========== ŸÑŸàÿØ€åŸÜ⁄Ø ÿÆÿ±⁄ÜŸÜ⁄Ø€å ========== */
        .waiting-loader {
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 30px;
            background: var(--card-bg);
            border-radius: 40px;
            margin: 20px 0;
        }

        .crab-loader {
            position: relative;
            width: 100px;
            height: 100px;
            margin-bottom: 20px;
        }

        .crab-body {
            position: absolute;
            width: 60px;
            height: 40px;
            background: linear-gradient(135deg, #ff6b6b, #ff4757);
            border-radius: 30px 30px 20px 20px;
            top: 30px;
            left: 20px;
            animation: bodyFloat 2s ease infinite;
        }

        .crab-eye {
            position: absolute;
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            top: 35px;
        }

        .crab-eye.left { left: 35px; }
        .crab-eye.right { left: 53px; }

        .crab-eye::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 6px;
            background: black;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            animation: eyeMove 2s ease infinite;
        }

        .crab-leg {
            position: absolute;
            width: 15px;
            height: 25px;
            background: #ff4757;
            border-radius: 10px;
            bottom: 25px;
        }

        .crab-leg.left1 { left: 25px; transform: rotate(-20deg); animation: legMove1 1s infinite; }
        .crab-leg.left2 { left: 40px; transform: rotate(-30deg); animation: legMove2 1s infinite; }
        .crab-leg.right1 { left: 55px; transform: rotate(20deg); animation: legMove1 1s infinite reverse; }
        .crab-leg.right2 { left: 70px; transform: rotate(30deg); animation: legMove2 1s infinite reverse; }

        .crab-claw {
            position: absolute;
            width: 25px;
            height: 25px;
            background: #ff4757;
            border-radius: 50% 50% 0 50%;
            top: 25px;
        }

        .crab-claw.left { left: 10px; transform: rotate(-45deg); animation: clawWave 1.5s infinite; }
        .crab-claw.right { left: 65px; transform: rotate(45deg); animation: clawWave 1.5s infinite reverse; }

        .waiting-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            color: var(--primary);
            display: flex;
            gap: 5px;
        }

        .dot { animation: dotPulse 1.5s infinite; }
        .dot:nth-child(2) { animation-delay: 0.5s; }
        .dot:nth-child(3) { animation-delay: 1s; }

        @keyframes bodyFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        @keyframes eyeMove {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(2px); }
        }

        @keyframes legMove1 {
            0%, 100% { transform: rotate(-20deg); }
            50% { transform: rotate(-40deg); }
        }

        @keyframes legMove2 {
            0%, 100% { transform: rotate(-30deg); }
            50% { transform: rotate(-50deg); }
        }

        @keyframes clawWave {
            0%, 100% { transform: rotate(-45deg) scale(1); }
            50% { transform: rotate(-60deg) scale(1.1); }
        }

        @keyframes dotPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; transform: translateY(-3px); }
        }

        /* ========== ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá ========== */
        .shop-section {
            max-height: 500px;
            overflow-y: auto;
        }

        .shop-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .frame-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .frame-preview {
            width: 60px;
            height: 60px;
            position: relative;
            flex-shrink: 0;
        }

        .preview-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
            z-index: 2;
        }

        .preview-frame {
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border-radius: 50%;
            z-index: 1;
        }

        .frame-info {
            flex: 1;
        }

        .frame-name {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .frame-price {
            color: var(--gold);
            font-size: 13px;
        }

        .buy-btn {
            background: linear-gradient(135deg, var(--primary), #818cf8);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 30px;
            font-size: 12px;
            cursor: pointer;
            min-width: 70px;
        }

        .buy-btn.owned {
            background: var(--success);
        }

        .buy-btn:disabled {
            opacity: 0.5;
        }

        /* ========== ŸÇÿßÿ®‚ÄåŸáÿß€å €± ÿ™ÿß €±€∞€∞ ========== */
        .frame-1::before { content: ''; position: absolute; inset: -8px; border-radius: 50%; border: 3px solid cyan; box-shadow: 0 0 20px cyan; animation: pulse 2s infinite; }
        .frame-2::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: conic-gradient(from 0deg, red, orange, yellow, green, blue, indigo, violet, red); animation: rotate 4s linear infinite; }
        .frame-3::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; box-shadow: 0 0 40px magenta, 0 0 60px magenta; animation: breathe 3s infinite; }
        .frame-4::before { content: ''; position: absolute; inset: -8px; border-radius: 50%; box-shadow: 0 0 0 0 rgba(255,255,0,0.5); animation: glowPulse 1s infinite; }
        .frame-5::before { content: ''; position: absolute; inset: -15px; border-radius: 50%; background: radial-gradient(circle, white, cyan, transparent); opacity: 0.7; animation: softGlow 3s infinite; }
        .frame-6::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: repeating-linear-gradient(45deg, #ff0000, #00ff00 10px, #0000ff 20px); animation: rotate 5s linear infinite; }
        .frame-7::before, .frame-7::after { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 2px solid transparent; border-top-color: red; border-bottom-color: blue; animation: spinPulse 2s infinite; }
        .frame-8::before { content: ''; position: absolute; inset: -14px; border-radius: 50%; background: repeating-radial-gradient(circle, cyan 0px, transparent 5px); animation: pulse 2s infinite; }
        .frame-9::before { content: ''; position: absolute; inset: -18px; border-radius: 50%; background: radial-gradient(circle, gold, transparent); filter: blur(8px); animation: tail 3s infinite; }
        .frame-10::before, .frame-10::after { content: ''; position: absolute; border-radius: 50%; }
        .frame-10::before { inset: -10px; border: 4px solid #ff00ff; box-shadow: 0 0 30px #ff00ff; }
        .frame-10::after { inset: -18px; border: 2px solid #00ffff; box-shadow: 0 0 40px #00ffff; animation: rotate 10s linear infinite; }
        .frame-11::before { content: ''; position: absolute; inset: -18px; border-radius: 50%; background: radial-gradient(circle, #ffaa00, #ff5500, #ff2200); filter: blur(8px); animation: flameDance 0.8s infinite alternate; }
        .frame-11::after { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: radial-gradient(circle, #ffff00, #ff8800, transparent); opacity: 0.7; animation: flameFlicker 0.3s infinite; }
        .frame-12::before { content: ''; position: absolute; inset: -15px; border-radius: 50%; background: linear-gradient(45deg, #ffff00, #00ffff, #ff00ff); filter: blur(5px); animation: thunder 0.5s steps(2) infinite; }
        .frame-13::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: radial-gradient(circle, #0000ff, #00ffff, transparent); filter: blur(10px); animation: flow 4s infinite; }
        .frame-14::before { content: ''; position: absolute; inset: -25px; border-radius: 50%; background: radial-gradient(circle, purple, violet, transparent); filter: blur(12px); animation: magicSpin 5s infinite; }
        .frame-14::after { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 3px solid rgba(255,215,0,0.5); box-shadow: 0 0 30px gold; animation: breathe 2s infinite; }
        .frame-15::before, .frame-15::after { content: '‚ú¶'; position: absolute; color: white; font-size: 20px; animation: particleOrbit 3s infinite; }
        .frame-16::before { content: ''; position: absolute; inset: -22px; border-radius: 50%; border: 2px dashed #00ff00; animation: rotate 8s linear infinite; }
        .frame-17::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: repeating-radial-gradient(circle, #ff00ff 0px, #00ffff 5px, transparent 10px); animation: plasma 2s infinite; }
        .frame-18::before { content: ''; position: absolute; inset: -35px; border-radius: 50%; background: radial-gradient(circle, white, red, transparent); filter: blur(10px); animation: explosion 4s infinite; }
        .frame-19::before, .frame-19::after { content: ''; position: absolute; inset: -22px; border-radius: 50%; background: rgba(128,128,128,0.3); filter: blur(15px); animation: smokeDrift 6s infinite; }
        .frame-20::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; box-shadow: 0 0 0 0 rgba(255,255,255,0.7); animation: energyPulse 1.5s infinite; }
        .frame-21::before { content: ''; position: absolute; inset: -8px; border-radius: 50%; background: conic-gradient(from 0deg, red, orange, yellow, green, blue, indigo, violet, red); animation: rotate 3s linear infinite; }
        .frame-22::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: linear-gradient(45deg, red, orange, yellow, green, blue, indigo, violet); background-size: 300% 300%; animation: gradientShift 5s infinite; }
        .frame-23::before { content: ''; position: absolute; inset: -9px; border-radius: 50%; background: linear-gradient(90deg, red, green, blue); background-size: 200% 100%; animation: slide 3s infinite; }
        .frame-24::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2, #6b8cff); animation: breathe 4s infinite; }
        .frame-25::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: radial-gradient(circle, gold, orange); animation: sparkle 2s infinite; }
        .frame-26::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: linear-gradient(45deg, #8b5cf6, #3b82f6, #06b6d4); animation: pulse 3s infinite; }
        .frame-27::before { content: ''; position: absolute; inset: -8px; border-radius: 50%; background: radial-gradient(circle at 30% 50%, silver, gray); filter: drop-shadow(0 0 10px silver); }
        .frame-28::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: linear-gradient(135deg, rgba(255,255,255,0.5), rgba(255,255,255,0.1)); backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.3); }
        .frame-29::before { content: ''; position: absolute; inset: -14px; border-radius: 50%; background: radial-gradient(circle at 30% 30%, #ff6b6b, #4ecdc4, #45b7d1); opacity: 0.7; filter: blur(2px); animation: float 5s infinite; }
        .frame-30::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: repeating-linear-gradient(45deg, red, green 20px, blue 40px); animation: wave 5s infinite; }
        .frame-31::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 4px solid gold; box-shadow: 0 0 30px gold, inset 0 0 20px gold; }
        .frame-32::before { content: ''; position: absolute; inset: -8px; border-radius: 50%; border: 3px solid #e5e4e2; box-shadow: 0 0 20px #e5e4e2, 0 0 40px silver; }
        .frame-33::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: radial-gradient(circle, #b9f2ff, transparent); filter: drop-shadow(0 0 20px #b9f2ff); animation: sparkle 2s infinite; }
        .frame-34::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: linear-gradient(135deg, #a5f3fc, #22d3ee, #0891b2); opacity: 0.6; filter: blur(2px); animation: breathe 3s infinite; }
        .frame-35::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.8); box-shadow: 0 0 0 2px rgba(255,255,255,0.3), 0 0 0 4px rgba(255,255,255,0.1); }
        .frame-36::before { content: ''; position: absolute; inset: -8px; border-radius: 50%; background: repeating-linear-gradient(45deg, silver, gray 5px); mask: radial-gradient(circle, transparent 60%, black 61%); }
        .frame-37::before, .frame-37::after { content: ''; position: absolute; border-radius: 50%; }
        .frame-37::before { inset: -12px; border: 3px solid gold; }
        .frame-37::after { inset: -18px; border: 1px solid silver; transform: rotate(45deg); animation: rotate 10s linear infinite; }
        .frame-38::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: radial-gradient(circle, black, gold); opacity: 0.8; }
        .frame-39::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 4px solid gold; filter: drop-shadow(0 0 20px gold) drop-shadow(0 0 40px gold); animation: pulse 2s infinite; }
        .frame-40::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: conic-gradient(from 0deg, red, green, blue, magenta, red); animation: hueRotate 4s linear infinite; }
        .frame-41::before { content: ''; position: absolute; inset: -5px; border-radius: 50%; border: 2px solid white; animation: pulse 2s infinite; }
        .frame-42::before { content: ''; position: absolute; inset: -6px; border-radius: 50%; border: 2px dotted cyan; animation: rotate 10s linear infinite; }
        .frame-43::before { content: ''; position: absolute; inset: -7px; border-radius: 50%; border: 2px dashed magenta; animation: dashMove 2s infinite; }
        .frame-44::before { content: ''; position: absolute; inset: -9px; border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; border: 2px solid lime; animation: morph 5s infinite; }
        .frame-45::before, .frame-45::after { content: ''; position: absolute; border-radius: 50%; border: 1px solid rgba(255,255,255,0.5); }
        .frame-45::before { inset: -7px; } .frame-45::after { inset: -12px; animation: rotate 6s linear infinite; }
        .frame-46::before { content: ''; position: absolute; inset: -9px; border-radius: 50%; box-shadow: 0 0 20px white; opacity: 0.5; animation: fade 3s infinite; }
        .frame-47::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; border: 2px solid transparent; border-top-color: cyan; border-bottom-color: magenta; animation: spinPulse 3s infinite; }
        .frame-48::before, .frame-48::after { content: ''; position: absolute; border-radius: 50%; }
        .frame-48::before { inset: -9px; border: 2px solid lime; clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%); }
        .frame-48::after { inset: -14px; border: 2px solid magenta; clip-path: polygon(20% 20%, 80% 20%, 80% 80%, 20% 80%); animation: rotate 5s linear infinite; }
        .frame-49::before { content: ''; position: absolute; inset: -22px; border-radius: 50%; background: repeating-linear-gradient(0deg, transparent, transparent 5px, rgba(0,255,0,0.1) 5px, rgba(0,255,0,0.1) 10px); animation: scan 2s infinite; }
        .frame-50::before { content: ''; position: absolute; inset: -7px; border-radius: 50%; box-shadow: 0 0 0 0 rgba(255,255,255,0.5); animation: breathe 3s infinite; }
        .frame-51::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; border: 4px solid; border-color: #00ff00 #ff0000 #0000ff #ffff00; box-shadow: 0 0 20px cyan; animation: rotate 4s linear infinite; }
        .frame-52::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: repeating-linear-gradient(45deg, magenta, cyan 10px); filter: blur(2px); animation: glitch 0.3s infinite; }
        .frame-53::before { content: ''; position: absolute; inset: -8px; border-radius: 50%; border: 4px solid; border-image: repeating-linear-gradient(45deg, black, white 5px) 1; }
        .frame-54::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: radial-gradient(circle at 30% 30%, #ff6b6b, #4ecdc4, #45b7d1); mix-blend-mode: screen; animation: pulse 2s infinite; }
        .frame-55::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 4px solid magenta; filter: drop-shadow(0 0 10px magenta) drop-shadow(0 0 20px cyan); animation: flicker 2s infinite; }
        .frame-56::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: repeating-radial-gradient(circle, lime, blue 10px, magenta 20px); animation: scan 3s infinite; }
        .frame-57::before { content: ''; position: absolute; inset: -18px; border-radius: 50%; background: repeating-linear-gradient(90deg, lime, lime 2px, transparent 2px, transparent 10px); animation: matrix 2s infinite; }
        .frame-58::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; background: linear-gradient(45deg, red, green, blue); filter: blur(3px); animation: glitch 0.2s infinite; }
        .frame-58::after { content: ''; position: absolute; inset: -7px; border-radius: 50%; border: 3px solid white; opacity: 0.3; animation: glitchBorder 0.3s infinite; }
        .frame-59::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; border: 3px solid; border-color: red green blue; animation: rotate 2s linear infinite; }
        .frame-60::before { content: ''; position: absolute; inset: -14px; border-radius: 50%; background: conic-gradient(from 0deg, lime, yellow, red, lime); mask: radial-gradient(circle, transparent 65%, black 66%); animation: level 3s linear infinite; }
        .frame-61::before { content: ''; position: absolute; inset: -18px; border-radius: 50%; background: radial-gradient(circle, gold, magenta, purple); filter: blur(10px); animation: fantasyGlow 3s infinite; }
        .frame-62::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: linear-gradient(135deg, cyan, magenta); background-size: 200% 200%; animation: mermaid 4s infinite; }
        .frame-63::before { content: '‚òÖ'; position: absolute; inset: -12px; display: flex; align-items: center; justify-content: center; color: gold; font-size: 30px; animation: starTwinkle 2s infinite; }
        .frame-64::before { content: ''; position: absolute; inset: -22px; border-radius: 50%; background: radial-gradient(circle, #000428, #004e92, #000428); opacity: 0.8; animation: galaxy 10s infinite; }
        .frame-65::before { content: ''; position: absolute; inset: -18px; border-radius: 50%; background: #800080; filter: blur(20px); opacity: 0.6; animation: purpleMist 5s infinite; }
        .frame-66::before { content: ''; position: absolute; inset: -22px; border-radius: 50%; background: conic-gradient(from 0deg, #00c6ff, #0072ff, #00c6ff); filter: blur(5px); animation: aurora 6s infinite; }
        .frame-67::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 3px solid white; animation: magicCircle 4s infinite; }
        .frame-68::before { content: '·ö†·ö¢·ö¶·ö®·ö±·ö≤'; position: absolute; inset: -12px; display: flex; align-items: center; justify-content: center; color: rgba(255,215,0,0.5); font-size: 12px; animation: runesRotate 10s infinite; }
        .frame-69::before { content: ''; position: absolute; inset: -28px; border-radius: 50%; background: radial-gradient(circle, rgba(255,255,255,0.8), transparent); filter: blur(20px); animation: fairyLight 3s infinite; }
        .frame-70::before { content: ''; position: absolute; inset: -32px; border-radius: 50%; background: conic-gradient(from 0deg, cyan, magenta, yellow, cyan); filter: blur(15px); opacity: 0.7; animation: portalSpin 3s infinite; }
        .frame-71::before { content: 'üåøüå±üçÉ'; position: absolute; inset: -18px; display: flex; align-items: center; justify-content: center; font-size: 20px; opacity: 0.5; animation: leavesFloat 5s infinite; }
        .frame-72::before { content: 'üå∏üåºüå∏'; position: absolute; inset: -18px; display: flex; align-items: center; justify-content: center; font-size: 20px; animation: blossom 4s infinite; }
        .frame-73::before { content: '‚ùÑÔ∏è‚ùÑÔ∏è‚ùÑÔ∏è'; position: absolute; inset: -12px; display: flex; align-items: center; justify-content: center; font-size: 20px; animation: snow 3s infinite; }
        .frame-74::before { content: 'üíßüíßüíß'; position: absolute; inset: -12px; display: flex; align-items: center; justify-content: center; font-size: 20px; animation: rain 1s infinite; }
        .frame-75::before { content: ''; position: absolute; inset: -22px; border-radius: 50%; background: radial-gradient(circle, cyan, blue); filter: blur(10px); opacity: 0.6; animation: waterWave 4s infinite; }
        .frame-76::before { content: ''; position: absolute; inset: -28px; border-radius: 50%; background: #708090; filter: blur(20px); opacity: 0.4; animation: smokeMist 7s infinite; }
        .frame-77::before { content: '„Äá„Äá„Äá'; position: absolute; inset: -12px; display: flex; align-items: center; justify-content: center; font-size: 16px; color: rgba(255,255,255,0.5); animation: bubbles 3s infinite; }
        .frame-78::before { content: ''; position: absolute; inset: -8px; border-radius: 50%; background: #8b4513; border: 2px solid #cd853f; }
        .frame-79::before { content: ''; position: absolute; inset: -8px; border-radius: 50%; background: #808080; clip-path: polygon(20% 0%, 80% 0%, 100% 20%, 100% 80%, 80% 100%, 20% 100%, 0% 80%, 0% 20%); animation: stoneRotate 10s infinite; }
        .frame-80::before { content: 'üå≤üå≥üå≤'; position: absolute; inset: -12px; display: flex; align-items: center; justify-content: center; font-size: 16px; animation: forest 6s infinite; }
        .frame-81::before { content: ''; position: absolute; inset: -18px; border-radius: 50%; border: 3px dashed gold; animation: rotate 4s linear infinite; }
        .frame-82 { animation: shake 0.5s infinite; }
        .frame-83 { animation: float 2s infinite; }
        .frame-84::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; border: 3px solid cyan; border-top-color: transparent; animation: timerRotate 1s linear infinite; }
        .frame-85::before { content: ''; position: absolute; inset: -18px; border-radius: 50%; background: repeating-radial-gradient(circle, lime 0px, transparent 5px); animation: radar 3s infinite; }
        .frame-86::before { content: ''; position: absolute; inset: -14px; border-radius: 50%; border: 3px solid white; filter: drop-shadow(0 0 10px cyan); animation: sineWave 2s infinite; }
        .frame-87::before { content: '‚Ä¢'; position: absolute; color: white; font-size: 20px; animation: orbit 3s infinite; }
        .frame-88 { transition: all 0.2s; } .frame-88:hover { transform: scale(1.1); filter: brightness(1.5); }
        .frame-89:active { transform: scale(0.9); filter: hue-rotate(90deg); }
        .frame-90::before { content: ''; position: absolute; inset: -12px; border-radius: 50%; background: conic-gradient(from 0deg, red, yellow, green, cyan, blue, magenta, red); filter: blur(5px); animation: soundViz 0.5s infinite; }
        .frame-91::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 4px solid #cd7f32; box-shadow: 0 0 30px #cd7f32; }
        .frame-92::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 4px solid #c0c0c0; box-shadow: 0 0 30px silver; }
        .frame-93::before { content: ''; position: absolute; inset: -10px; border-radius: 50%; border: 4px solid gold; box-shadow: 0 0 30px gold; }
        .frame-94::before { content: ''; position: absolute; inset: -14px; border-radius: 50%; border: 6px double gold; box-shadow: 0 0 50px gold; animation: legendaryPulse 2s infinite; }
        .frame-95::before { content: 'üèÜ'; position: absolute; top: -18px; left: 50%; transform: translateX(-50%); font-size: 20px; animation: trophyFloat 3s infinite; }
        .frame-96::before { content: 'üëë'; position: absolute; top: -22px; left: 50%; transform: translateX(-50%); font-size: 24px; filter: drop-shadow(0 0 10px gold); }
        .frame-97::before { content: 'üî•'; position: absolute; inset: -12px; display: flex; align-items: center; justify-content: center; font-size: 30px; animation: streakFire 1s infinite; }
        .frame-98::before { content: '‚≠ê'; position: absolute; inset: -12px; display: flex; align-items: center; justify-content: center; font-size: 30px; animation: vipStar 2s infinite; }
        .frame-99::before { content: 'üéâ'; position: absolute; inset: -12px; display: flex; align-items: center; justify-content: center; font-size: 30px; animation: eventConfetti 2s infinite; }
        .frame-100::before { content: ''; position: absolute; inset: -18px; border-radius: 50%; background: radial-gradient(circle, gold, orange, magenta); filter: blur(8px); opacity: 0.7; animation: prestigeGlow 3s infinite; }

        /* ========== ÿßŸÜ€åŸÖ€åÿ¥ŸÜ‚ÄåŸáÿß ========== */
        @keyframes pulse { 0%, 100% { opacity: 0.6; transform: scale(1); } 50% { opacity: 1; transform: scale(1.1); } }
        @keyframes breathe { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        @keyframes glowPulse { 0%, 100% { box-shadow: 0 0 0 5px rgba(255,255,0,0.5); } 50% { box-shadow: 0 0 0 15px rgba(255,255,0,0.2); } }
        @keyframes spinPulse { 0% { transform: rotate(0deg) scale(1); } 50% { transform: rotate(180deg) scale(1.1); } 100% { transform: rotate(360deg) scale(1); } }
        @keyframes tail { 0%, 100% { transform: scale(1); opacity: 0.5; } 50% { transform: scale(1.2); opacity: 1; } }
        @keyframes flameDance { 0% { transform: scale(1) rotate(0deg); filter: hue-rotate(0deg); } 100% { transform: scale(1.2) rotate(5deg); filter: hue-rotate(20deg); } }
        @keyframes flameFlicker { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        @keyframes thunder { 0%, 100% { opacity: 0.8; filter: brightness(1); } 50% { opacity: 1; filter: brightness(2); } }
        @keyframes flow { 0% { transform: rotate(0deg) scale(1); } 50% { transform: rotate(180deg) scale(1.1); } 100% { transform: rotate(360deg) scale(1); } }
        @keyframes magicSpin { 0% { transform: rotate(0deg) scale(1); } 50% { transform: rotate(180deg) scale(1.2); } 100% { transform: rotate(360deg) scale(1); } }
        @keyframes particleOrbit { 0% { opacity: 0; transform: translate(0,0) rotate(0deg); } 50% { opacity: 1; } 100% { opacity: 0; transform: translate(20px,-20px) rotate(360deg); } }
        @keyframes plasma { 0% { filter: hue-rotate(0deg) blur(2px); } 100% { filter: hue-rotate(360deg) blur(2px); } }
        @keyframes explosion { 0% { transform: scale(0.5); opacity: 1; } 50% { transform: scale(1.8); opacity: 0.4; } 100% { transform: scale(0.5); opacity: 1; } }
        @keyframes smokeDrift { 0% { transform: scale(1) translate(0,0); opacity: 0.3; } 33% { transform: scale(1.2) translate(5px,-5px); opacity: 0.6; } 66% { transform: scale(0.9) translate(-5px,5px); opacity: 0.4; } 100% { transform: scale(1) translate(0,0); opacity: 0.3; } }
        @keyframes energyPulse { 0% { box-shadow: 0 0 0 0 rgba(255,255,255,0.7); } 70% { box-shadow: 0 0 0 20px rgba(255,255,255,0); } 100% { box-shadow: 0 0 0 0 rgba(255,255,255,0); } }
        @keyframes softGlow { 0%, 100% { opacity: 0.6; transform: scale(1); } 50% { opacity: 1; transform: scale(1.1); } }
        @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        @keyframes slide { 0% { background-position: 0% 0%; } 100% { background-position: 200% 0%; } }
        @keyframes sparkle { 0%, 100% { filter: brightness(1); } 50% { filter: brightness(1.5); } }
        @keyframes dashMove { 0% { background-position: 0 0; } 100% { background-position: 20px 0; } }
        @keyframes morph { 0%, 100% { border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; } 25% { border-radius: 50% 50% 50% 50% / 60% 40% 60% 40%; } 50% { border-radius: 70% 30% 30% 70% / 70% 70% 30% 30%; } 75% { border-radius: 40% 60% 40% 60% / 40% 60% 40% 60%; } }
        @keyframes fade { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.8; } }
        @keyframes scan { 0% { transform: translateY(-100%); } 100% { transform: translateY(100%); } }
        @keyframes glitch { 0% { transform: translate(0); filter: hue-rotate(0deg); } 25% { transform: translate(-2px,2px); filter: hue-rotate(90deg); } 50% { transform: translate(2px,-2px); filter: hue-rotate(180deg); } 75% { transform: translate(-2px,-2px); filter: hue-rotate(270deg); } 100% { transform: translate(0); filter: hue-rotate(360deg); } }
        @keyframes glitchBorder { 0% { border-color: red; opacity: 0.5; } 33% { border-color: blue; opacity: 0.8; } 66% { border-color: green; opacity: 0.3; } }
        @keyframes matrix { 0% { background-position: 0% 0%; } 100% { background-position: 0% 100%; } }
        @keyframes level { 0% { filter: hue-rotate(0deg) brightness(1); } 50% { filter: hue-rotate(180deg) brightness(1.5); } 100% { filter: hue-rotate(360deg) brightness(1); } }
        @keyframes timerRotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes radar { 0% { background-position: 0% 0%; } 100% { background-position: 100% 100%; } }
        @keyframes sineWave { 0%, 100% { border-radius: 50%; } 25% { border-radius: 60% 40% 40% 60% / 60% 40% 60% 40%; } 50% { border-radius: 40% 60% 60% 40% / 40% 60% 40% 60%; } 75% { border-radius: 60% 40% 40% 60% / 40% 60% 60% 40%; } }
        @keyframes orbit { 0% { transform: rotate(0deg) translate(25px) rotate(0deg); } 100% { transform: rotate(360deg) translate(25px) rotate(-360deg); } }
        @keyframes soundViz { 0% { filter: blur(5px); opacity: 0.5; } 33% { filter: blur(15px); opacity: 1; } 66% { filter: blur(8px); opacity: 0.7; } }
        @keyframes legendaryPulse { 0%, 100% { box-shadow: 0 0 30px gold; } 50% { box-shadow: 0 0 60px #ffaa00; } }
        @keyframes trophyFloat { 0%, 100% { transform: translateX(-50%) translateY(0); } 50% { transform: translateX(-50%) translateY(-5px); } }
        @keyframes streakFire { 0%, 100% { filter: hue-rotate(0deg); } 50% { filter: hue-rotate(30deg); } }
        @keyframes vipStar { 0%, 100% { transform: scale(1); filter: drop-shadow(0 0 5px gold); } 50% { transform: scale(1.2); filter: drop-shadow(0 0 20px gold); } }
        @keyframes eventConfetti { 0% { transform: rotate(0deg); } 25% { transform: rotate(10deg); } 75% { transform: rotate(-10deg); } }
        @keyframes prestigeGlow { 0%, 100% { filter: blur(8px) hue-rotate(0deg); } 50% { filter: blur(15px) hue-rotate(30deg); } }
        @keyframes leavesFloat { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        @keyframes blossom { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        @keyframes snow { 0% { transform: translateY(-10px); opacity: 0; } 50% { opacity: 1; } 100% { transform: translateY(10px); opacity: 0; } }
        @keyframes rain { 0% { transform: translateY(-5px); opacity: 0; } 50% { opacity: 1; } 100% { transform: translateY(5px); opacity: 0; } }
        @keyframes waterWave { 0%, 100% { transform: scale(1); opacity: 0.5; } 50% { transform: scale(1.2); opacity: 0.8; } }
        @keyframes smokeMist { 0%, 100% { filter: blur(20px) opacity(0.3); } 50% { filter: blur(30px) opacity(0.6); } }
        @keyframes bubbles { 0% { transform: scale(0.5); opacity: 0; } 50% { opacity: 1; } 100% { transform: scale(1.5); opacity: 0; } }
        @keyframes stoneRotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes forest { 0%, 100% { filter: hue-rotate(0deg); } 50% { filter: hue-rotate(30deg); } }
        @keyframes runesRotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes fairyLight { 0%, 100% { filter: blur(20px) brightness(1); } 50% { filter: blur(30px) brightness(1.5); } }
        @keyframes portalSpin { from { transform: rotate(0deg) scale(1); } to { transform: rotate(360deg) scale(1); } }
        @keyframes galaxy { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes starTwinkle { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        @keyframes mermaid { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        @keyframes fantasyGlow { 0%, 100% { filter: blur(10px) hue-rotate(0deg); } 50% { filter: blur(20px) hue-rotate(30deg); } }
        @keyframes purpleMist { 0%, 100% { filter: blur(20px) opacity(0.4); } 50% { filter: blur(30px) opacity(0.8); } }
        @keyframes aurora { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
        @keyframes magicCircle { 0% { transform: rotate(0deg) scale(1); border-color: white; } 50% { transform: rotate(180deg) scale(1.1); border-color: gold; } 100% { transform: rotate(360deg) scale(1); border-color: white; } }
        @keyframes hueRotate { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-2px); } 75% { transform: translateX(2px); } }
        @keyframes flicker { 0%, 100% { opacity: 0.9; } 50% { opacity: 0.4; } }

        .footer {
            margin-top: 20px;
            padding: 16px;
            text-align: center;
            font-size: 12px;
            color: var(--text-secondary);
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 30px;
        }

        @media (max-width: 400px) {
            .header { flex-direction: column; }
            .header h1 { text-align: center; }
            .header-buttons { justify-content: center; }
        }
    </style>
</head>
<body data-theme="dark">
    <div class="container">
        <!-- ŸáÿØÿ± -->
        <header class="header">
            <h1>‚ö° ARENA</h1>
            <div class="header-buttons">
                <div class="theme-switch" onclick="toggleTheme()">
                    <div class="theme-slider">
                        <div class="theme-knob" id="themeKnob"></div>
                        <div class="theme-icon">
                            <span>üåô</span>
                            <span>‚òÄÔ∏è</span>
                        </div>
                    </div>
                </div>
                <button class="shop-btn" onclick="showSection('shop')">
                    <span>üõí</span>
                    <span>ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá</span>
                </button>
            </div>
        </header>

        <!-- Ÿæÿ±ŸàŸÅÿß€åŸÑ -->
        <div class="profile-card">
            <div class="profile-row">
                <div class="avatar-container" id="avatarContainer">
                    <div class="avatar-frame" id="avatarFrame"></div>
                    <div class="avatar-img" id="avatarImg">üë§</div>
                </div>
                <div class="profile-info">
                    <div class="profile-name" id="userName">⁄©ÿßÿ±ÿ®ÿ±</div>
                    <div class="profile-stats">
                        <span>üèÜ <span id="userWins">€∞</span></span>
                        <span>‚≠ê ÿ≥ÿ∑ÿ≠ <span id="userLevel">€±</span></span>
                    </div>
                    <div class="coins" id="userCoins">üí∞ €µ€∞€∞€∞</div>
                </div>
            </div>
        </div>

        <!-- ŸÜŸà€å⁄Ø€åÿ¥ŸÜ -->
        <div class="game-nav">
            <button class="nav-btn" onclick="showSection('bot')">ü§ñ ÿ®ÿß ÿ±ÿ®ÿßÿ™</button>
            <button class="nav-btn" onclick="showSection('online')">üåê ÿ¢ŸÜŸÑÿß€åŸÜ</button>
        </div>

        <!-- ÿ®ÿÆÿ¥ ÿ®ÿßÿ™ -->
        <div id="botSection" class="game-section active">
            <div class="game-card">
                <div class="mode-switch">
                    <div class="mode-option active" onclick="setGameMode('easy')">üòä ÿ¢ÿ≥ÿßŸÜ</div>
                    <div class="mode-option" onclick="setGameMode('advanced')">üî• Ÿæ€åÿ¥ÿ±ŸÅÿ™Ÿá</div>
                </div>

                <div class="vs-container">
                    <div class="vs-box player">
                        <div class="score-badge" id="playerScore">€∞</div>
                        <h3>ÿ¥ŸÖÿß</h3>
                        <div class="choice-display" id="playerChoice">‚ùì</div>
                    </div>
                    <div class="vs-divider">VS</div>
                    <div class="vs-box bot">
                        <div class="score-badge" id="botScore">€∞</div>
                        <h3>ÿ±ÿ®ÿßÿ™</h3>
                        <div class="choice-display" id="botChoice">‚ùì</div>
                    </div>
                </div>

                <div class="result-message" id="resultMessage">‚ú® ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ ‚ú®</div>

                <div id="advancedGuideBtn" style="display: none;">
                    <button class="choose-btn" onclick="toggleGuide()" style="margin-bottom: 10px; background: linear-gradient(135deg, #f59e0b, #fbbf24);">
                        <span class="arrow-icon" id="guideArrow">‚ñº</span>
                        <span>üìö ÿ±ÿßŸáŸÜŸÖÿß€å ÿπŸÜÿßÿµÿ±</span>
                        <span class="arrow-icon">‚ñº</span>
                    </button>
                    <div class="guide-wrapper" id="guideWrapper">
                        <div class="guide-grid" id="guideGrid"></div>
                    </div>
                </div>

                <button class="choose-btn" onclick="toggleChoices()">
                    <span class="arrow-icon" id="arrowIcon">‚ñº</span>
                    <span id="btnText">ÿπŸÜÿßÿµÿ± ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ</span>
                    <span class="arrow-icon" id="arrowIcon2">‚ñº</span>
                </button>

                <div class="choices-wrapper" id="choicesWrapper">
                    <div class="choices-grid" id="choicesGrid"></div>
                </div>
            </div>
        </div>

        <!-- ÿ®ÿÆÿ¥ ÿ¢ŸÜŸÑÿß€åŸÜ -->
        <div id="onlineSection" class="game-section">
            <div class="game-card">
                <div class="online-section">
                    <div class="room-controls">
                        <input type="text" id="roomId" class="room-input" placeholder="⁄©ÿØ ÿßÿ™ÿßŸÇ">
                        <button class="choose-btn" onclick="createRoom()" style="margin: 0; padding: 12px;">ÿ≥ÿßÿÆÿ™ ÿßÿ™ÿßŸÇ</button>
                        <button class="choose-btn" onclick="joinRoom()" style="margin: 0; padding: 12px; background: linear-gradient(135deg, #10b981, #059669);">Ÿàÿ±ŸàÿØ</button>
                    </div>

                    <div id="onlineGameArea" style="display: none;">
                        <div class="vs-container">
                            <div class="vs-box player">
                                <div class="score-badge" id="onlinePlayerScore">€∞</div>
                                <h3>ÿ¥ŸÖÿß</h3>
                                <div class="choice-display" id="onlinePlayerChoice">‚ùì</div>
                            </div>
                            <div class="vs-divider">VS</div>
                            <div class="vs-box bot">
                                <div class="score-badge" id="onlineOpponentScore">€∞</div>
                                <h3>ÿ≠ÿ±€åŸÅ</h3>
                                <div class="choice-display" id="onlineOpponentChoice">‚ùì</div>
                            </div>
                        </div>

                        <div class="result-message" id="onlineResult">ŸÖŸÜÿ™ÿ∏ÿ± ÿ≠ÿ±€åŸÅ...</div>

                        <div id="waitingLoader" class="waiting-loader">
                            <div class="crab-loader">
                                <div class="crab-body"></div>
                                <div class="crab-eye left"></div>
                                <div class="crab-eye right"></div>
                                <div class="crab-leg left1"></div>
                                <div class="crab-leg left2"></div>
                                <div class="crab-leg right1"></div>
                                <div class="crab-leg right2"></div>
                                <div class="crab-claw left"></div>
                                <div class="crab-claw right"></div>
                            </div>
                            <div class="waiting-text">
                                <span>ÿØÿ± ÿßŸÜÿ™ÿ∏ÿßÿ± ÿ≠ÿ±€åŸÅ</span>
                                <span class="dot">.</span>
                                <span class="dot">.</span>
                                <span class="dot">.</span>
                            </div>
                        </div>

                        <div class="mode-switch" style="margin-top: 20px;">
                            <div class="mode-option active" onclick="setOnlineMode('easy')">üòä ÿ¢ÿ≥ÿßŸÜ</div>
                            <div class="mode-option" onclick="setOnlineMode('advanced')">üî• Ÿæ€åÿ¥ÿ±ŸÅÿ™Ÿá</div>
                        </div>

                        <button class="choose-btn" onclick="toggleOnlineChoices()">
                            <span class="arrow-icon" id="onlineArrowIcon">‚ñº</span>
                            <span id="onlineBtnText">ÿπŸÜÿßÿµÿ± ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ</span>
                            <span class="arrow-icon">‚ñº</span>
                        </button>

                        <div class="choices-wrapper" id="onlineChoicesWrapper">
                            <div class="choices-grid" id="onlineChoicesGrid"></div>
                        </div>

                        <button class="choose-btn" onclick="leaveRoom()" style="background: linear-gradient(135deg, #ef4444, #dc2626); margin-top: 10px;">ÿÆÿ±Ÿàÿ¨ ÿßÿ≤ ÿßÿ™ÿßŸÇ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ŸÅÿ±Ÿàÿ¥⁄ØÿßŸá -->
        <div id="shopSection" class="shop-section">
            <div class="shop-title">
                <span>üõí</span> ŸÇÿßÿ®‚ÄåŸáÿß€å ŸÖÿ™ÿßŸÑ€å⁄© (€±€∞€∞ ŸÇÿßÿ® Ÿà€å⁄òŸá)
            </div>
            <div id="framesList"></div>
        </div>

        <!-- ŸÅŸàÿ™ÿ± -->
        <div class="footer">
            <span>üî• Streak: <span id="streakDisplay">€∞</span></span>
            <span style="margin: 0 15px;">‚Ä¢</span>
            <span>üíæ ÿ∞ÿÆ€åÿ±Ÿá ÿÆŸàÿØ⁄©ÿßÿ±</span>
        </div>
    </div>

    <script>
        // ŸÇŸàÿßŸÜ€åŸÜ ÿ®ÿßÿ≤€å Ÿæ€åÿ¥ÿ±ŸÅÿ™Ÿá
        const advancedRules = {
            '⁄Øÿ±⁄Ø': { loses: ['ÿ™ŸÅŸÜ⁄Ø', 'ÿ≥ŸÜ⁄Ø', 'ÿ¢ÿ™ÿ¥', 'ŸÇ€å⁄Ü€å', 'ŸÖÿßÿ±', 'ÿßŸÜÿ≥ÿßŸÜ', 'ÿØÿ±ÿÆÿ™'], wins: ['ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®', 'ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨'] },
            'ÿØÿ±ÿÆÿ™': { loses: ['ÿµÿßÿπŸÇŸá', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿ≥ŸÜ⁄Ø', 'ÿ¢ÿ™ÿ¥', 'ŸÇ€å⁄Ü€å', 'ŸÖÿßÿ±', 'ÿßŸÜÿ≥ÿßŸÜ'], wins: ['ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®', 'ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø'] },
            'ÿßŸÜÿ≥ÿßŸÜ': { loses: ['ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ'], wins: ['ÿØÿ±ÿÆÿ™', '⁄Øÿ±⁄Ø', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄©ÿßÿ∫ÿ∞', 'ÿ®ÿßÿØ', 'ÿ¢ÿ®', 'ÿß⁄òÿØŸáÿß'] },
            'ŸÖÿßÿ±': { loses: ['ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿß⁄òÿØŸáÿß', 'ÿ¥€åÿ∑ÿßŸÜ'], wins: ['ÿ¢ÿ®', 'ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ'] },
            'ŸÇ€å⁄Ü€å': { loses: ['ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®'], wins: ['ŸÖÿßÿ±', 'ÿßŸÜÿ≥ÿßŸÜ', 'ÿØÿ±ÿÆÿ™', '⁄Øÿ±⁄Ø', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄©ÿßÿ∫ÿ∞', 'ÿ®ÿßÿØ'] },
            'ÿ¢ÿ™ÿ¥': { loses: ['ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®', 'ÿ®ÿßÿØ'], wins: ['⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ', 'ŸÖÿßÿ±', 'ŸÇ€å⁄Ü€å'] },
            'ÿ≥ŸÜ⁄Ø': { loses: ['ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®', 'ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞'], wins: ['ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ', 'ŸÖÿßÿ±', 'ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥'] },
            'ÿ™ŸÅŸÜ⁄Ø': { loses: ['ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®', 'ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨'], wins: ['⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ', 'ŸÖÿßÿ±', 'ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø'] },
            'ÿµÿßÿπŸÇŸá': { loses: ['ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®', 'ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø'], wins: ['ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ', 'ŸÖÿßÿ±', 'ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø'] },
            'ÿ¥€åÿ∑ÿßŸÜ': { loses: ['ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®', 'ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™'], wins: ['ÿßŸÜÿ≥ÿßŸÜ', 'ŸÖÿßÿ±', 'ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá'] },
            'ÿß⁄òÿØŸáÿß': { loses: ['ÿ¢ÿ®', 'ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ'], wins: ['ŸÖÿßÿ±', 'ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ'] },
            'ÿ¢ÿ®': { loses: ['ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ', 'ŸÖÿßÿ±'], wins: ['ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß'] },
            'ÿ®ÿßÿØ': { loses: ['⁄©ÿßÿ∫ÿ∞', 'ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ', 'ŸÖÿßÿ±', 'ŸÇ€å⁄Ü€å'], wins: ['ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿß⁄òÿØŸáÿß', 'ÿ¥€åÿ∑ÿßŸÜ', 'ÿ¢ÿ®'] },
            '⁄©ÿßÿ∫ÿ∞': { loses: ['ÿßÿ≥ŸÅŸÜÿ¨', '⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ', 'ŸÖÿßÿ±', 'ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥'], wins: ['ÿ≥ŸÜ⁄Ø', 'ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®', 'ÿ®ÿßÿØ'] },
            'ÿßÿ≥ŸÅŸÜÿ¨': { loses: ['⁄Øÿ±⁄Ø', 'ÿØÿ±ÿÆÿ™', 'ÿßŸÜÿ≥ÿßŸÜ', 'ŸÖÿßÿ±', 'ŸÇ€å⁄Ü€å', 'ÿ¢ÿ™ÿ¥', 'ÿ≥ŸÜ⁄Ø'], wins: ['ÿ™ŸÅŸÜ⁄Ø', 'ÿµÿßÿπŸÇŸá', 'ÿ¥€åÿ∑ÿßŸÜ', 'ÿß⁄òÿØŸáÿß', 'ÿ¢ÿ®', 'ÿ®ÿßÿØ', '⁄©ÿßÿ∫ÿ∞'] }
        };

        // ÿπŸÜÿßÿµÿ± ÿ®ÿßÿ≤€å
        const elements = {
            easy: [
                { name: 'ÿ≥ŸÜ⁄Ø', emoji: 'ü™®' },
                { name: '⁄©ÿßÿ∫ÿ∞', emoji: 'üìÑ' },
                { name: 'ŸÇ€å⁄Ü€å', emoji: '‚úÇÔ∏è' }
            ],
            advanced: [
                { name: 'ÿ≥ŸÜ⁄Ø', emoji: 'ü™®' }, { name: '⁄©ÿßÿ∫ÿ∞', emoji: 'üìÑ' }, { name: 'ŸÇ€å⁄Ü€å', emoji: '‚úÇÔ∏è' },
                { name: 'ÿ™ŸÅŸÜ⁄Ø', emoji: 'üî´' }, { name: 'ÿµÿßÿπŸÇŸá', emoji: '‚ö°' }, { name: 'ÿ¥€åÿ∑ÿßŸÜ', emoji: 'üòà' },
                { name: 'ÿß⁄òÿØŸáÿß', emoji: 'üêâ' }, { name: 'ÿ¢ÿ®', emoji: 'üíß' }, { name: 'ÿ®ÿßÿØ', emoji: 'üå™Ô∏è' },
                { name: 'ÿßÿ≥ŸÅŸÜÿ¨', emoji: 'üßΩ' }, { name: '⁄Øÿ±⁄Ø', emoji: 'üê∫' }, { name: 'ÿØÿ±ÿÆÿ™', emoji: 'üå≥' },
                { name: 'ÿßŸÜÿ≥ÿßŸÜ', emoji: 'üë§' }, { name: 'ŸÖÿßÿ±', emoji: 'üêç' }, { name: 'ÿ¢ÿ™ÿ¥', emoji: 'üî•' }
            ]
        };

        // €±€∞€∞ ŸÇÿßÿ®
        const frames = Array.from({ length: 100 }, (_, i) => ({
            id: i + 1,
            name: `ŸÇÿßÿ® ÿ¥ŸÖÿßÿ±Ÿá ${i + 1}`,
            class: `frame-${i + 1}`,
            price: Math.floor((i + 1) * 100)
        }));

        const specialNames = [
            'ŸÜÿ¶ŸàŸÜ ÿ≥ÿßÿØŸá', 'ŸÜÿ¶ŸàŸÜ ⁄Øÿ±ÿßÿØ€åÿßŸÜÿ™', '⁄ØŸÑŸà ÿ™ŸÜŸÅÿ≥€å', '⁄ØŸÑŸà ÿ∂ÿ±ÿ®ÿßŸÜ€å', 'ŸáÿßŸÑŸá ŸÜŸàÿ± ŸÜÿ±ŸÖ',
            'ŸÜŸàÿ± RGB ⁄Üÿ±ÿÆÿ¥€å', 'ŸÜŸàÿ± ŸÑ€åÿ≤ÿ±€å', 'ŸÜŸàÿ± ŸÖŸàÿ¨€å', 'ŸÜŸàÿ± ÿØŸÜÿ®ÿßŸÑŸá‚ÄåÿØÿßÿ±', '⁄ØŸÑŸà ÿØŸàÿ®ŸÑ',
            'ÿ¥ÿπŸÑŸá ÿ¢ÿ™ÿ¥', 'ÿ®ÿ±ŸÇ ÿµÿßÿπŸÇŸá‚Äåÿß€å', 'ÿßŸÜÿ±⁄ò€å ÿ¢ÿ®€å', 'ŸáÿßŸÑŸá ÿ¨ÿßÿØŸà€å€å', 'ÿ∞ÿ±ÿßÿ™ ÿßŸÜÿ±⁄ò€å',
            'ŸÖŸàÿ¨ ÿßŸÜÿ±⁄ò€å', 'ÿ≠ŸÑŸÇŸá ŸæŸÑÿßÿ≥ŸÖÿß', 'ÿßŸÜŸÅÿ¨ÿßÿ± ÿ¢ÿ±ÿßŸÖ', 'ÿØŸàÿØ ŸÜÿ±ŸÖ', 'ŸæÿßŸÑÿ≥ ÿßŸÜÿ±⁄ò€å',
            '⁄Øÿ±ÿßÿØ€åÿßŸÜÿ™ ⁄Üÿ±ÿÆÿßŸÜ', 'ÿ±ŸÜ⁄Ø€åŸÜ‚Äå⁄©ŸÖÿßŸÜ€å', 'ÿÆÿ∑€å ŸÖÿ™ÿ≠ÿ±⁄©', '⁄Øÿ±ÿßÿØ€åÿßŸÜÿ™ ŸÖŸàÿ±ÿ®', '⁄Øÿ±ÿßÿØ€åÿßŸÜÿ™ ÿ∑ŸÑÿß€å€å',
            'ÿ®ŸÜŸÅÿ¥-ÿ¢ÿ®€å', 'ŸÖÿ™ÿßŸÑ€å⁄©', 'ÿ¥€åÿ¥Ÿá‚Äåÿß€å', 'ŸÜÿ±ŸÖ Ÿæÿ±€åŸÖ€åŸàŸÖ', '⁄Øÿ±ÿßÿØ€åÿßŸÜÿ™ ŸÖŸàÿ¨€å',
            'ÿ∑ŸÑÿß€å€å ÿ®ÿ±ÿßŸÇ', 'ŸæŸÑÿßÿ™€åŸÜ€åŸàŸÖ€å', 'ÿßŸÑŸÖÿßÿ≥€å', '⁄©ÿ±€åÿ≥ÿ™ÿßŸÑ€å', 'ÿ¥€åÿ¥Ÿá ÿ™ÿ±ÿßÿ¥',
            'ŸÖÿ™ÿßŸÑ ÿ®ÿ±ÿ≥‚ÄåÿÆŸàÿ±ÿØŸá', 'ÿ≥ŸÑÿ∑ŸÜÿ™€å', 'ŸÖÿ¥⁄©€å ÿ∑ŸÑÿß€å€å', 'VIP', 'ŸáŸàŸÑŸà⁄Øÿ±ÿßŸÅ€å⁄©',
            'ÿÆÿ∑ ŸÜÿßÿ≤⁄©', 'ŸÜŸÇÿ∑Ÿá‚Äå⁄Ü€åŸÜ', 'dashed ŸÖÿ™ÿ≠ÿ±⁄©', '⁄ØŸàÿ¥Ÿá‚ÄåÿØÿßÿ± ŸÖÿØÿ±ŸÜ', 'ÿØŸàÿÆÿ∑€å ÿ∏ÿ±€åŸÅ',
            'ŸÖÿ≠Ÿà ÿ¥ŸàŸÜÿØŸá', 'ŸÜ€åŸÖŸá‚ÄåÿØÿß€åÿ±Ÿá', '⁄ØŸàÿ¥Ÿá ŸÜŸàÿ±ÿßŸÜ€å', 'ÿÆÿ∑ ÿßÿ≥⁄©ŸÜ', 'ŸÖ€åŸÜ€åŸÖÿßŸÑ ÿ™ŸÜŸÅÿ≥€å',
            'HUD ⁄Ø€åŸÖÿ±€å', 'ÿ≥ÿß€åÿ®ÿ±ŸæÿßŸÜ⁄©', 'Ÿæ€å⁄©ÿ≥ŸÑ€å', 'ÿ¢ÿ±⁄©€åÿØ', 'ÿ±ÿ™ÿ±Ÿà ⁄Ø€åŸÖ',
            'ÿØ€åÿ¨€åÿ™ÿßŸÑ ÿßÿ≥⁄©ŸÜ', 'ŸÖÿßÿ™ÿ±€å⁄©ÿ≥€å', '⁄ØŸÑ€å⁄Ü', 'ŸÑ€åÿ≤ÿ±€å ⁄Ø€åŸÖ', 'XP ŸÑŸàŸÑ‚ÄåÿØÿßÿ±',
            'ÿ¨ÿßÿØŸà€å€å', 'Ÿæÿ±€å ÿØÿ±€åÿß€å€å', 'ÿ≥ÿ™ÿßÿ±Ÿá‚Äåÿß€å', '⁄©Ÿá⁄©ÿ¥ÿßŸÜ€å', 'ŸÖŸá ÿ®ŸÜŸÅÿ¥',
            'ÿ¥ŸÅŸÇ ŸÇÿ∑ÿ®€å', '⁄Øÿ±ÿØ ÿ¨ÿßÿØŸà€å€å', 'ÿ±ŸàŸÜ‚ÄåŸáÿß€å ÿ®ÿßÿ≥ÿ™ÿßŸÜ€å', 'ŸÜŸàÿ± Ÿæÿ±€å', 'ŸæŸàÿ±ÿ™ÿßŸÑ',
            'ÿ®ÿ±⁄Ø‚ÄåŸáÿß€å ŸÖÿ™ÿ≠ÿ±⁄©', 'ÿ¥⁄©ŸàŸÅŸá‚ÄåŸáÿß€å ÿ¥ŸÜÿßŸàÿ±', 'ÿ®ÿ±ŸÅ ÿØÿ± ÿ≠ÿßŸÑ ÿ®ÿßÿ±ÿ¥', 'ÿ®ÿßÿ±ÿßŸÜ ŸÜÿ±ŸÖ', 'ŸÖŸàÿ¨ ÿ¢ÿ®',
            'ÿØŸàÿØ ŸÖŸá‚Äåÿ¢ŸÑŸàÿØ', 'ÿ≠ÿ®ÿßÿ®‚ÄåŸáÿß€å ÿ¢ÿ®', 'ŸÇÿßÿ® ⁄ÜŸàÿ®€å', 'ŸÇÿßÿ® ÿ≥ŸÜ⁄Ø€å', 'ÿ¨ŸÜ⁄ØŸÑ€å',
            '⁄Üÿ±ÿÆÿßŸÜ ⁄©ÿßŸÖŸÑ', 'ŸÑÿ±ÿ≤ÿ¥€å ŸÜÿ±ŸÖ', 'bounce ÿ¢ÿ±ÿßŸÖ', 'ÿ™ÿß€åŸÖÿ± ÿØŸàÿ±ÿßŸÜ€å', 'ÿßÿ≥⁄©ŸÜ ÿ±ÿßÿØÿßÿ±€å',
            'ŸÖŸàÿ¨ ÿ≥€åŸÜŸàÿ≥€å', 'orbit ÿ∞ÿ±ÿßÿ™', 'ÿØŸÜÿ®ÿßŸÑ‚Äå⁄©ŸÜŸÜÿØŸá ŸÖŸàÿ≥', 'Ÿàÿß⁄©ŸÜÿ¥€å ÿ®Ÿá ⁄©ŸÑ€å⁄©', 'visualizer',
            'ÿ®ÿ±ŸÜÿ≤€å', 'ŸÜŸÇÿ±Ÿá‚Äåÿß€å', 'ÿ∑ŸÑÿß€å€å ÿ±ŸÜ⁄©', 'ÿßŸÅÿ≥ÿßŸÜŸá‚Äåÿß€å', 'ŸÇŸáÿ±ŸÖÿßŸÜ ŸÅÿµŸÑ',
            'ÿ™ÿßŸæ ŸÑ€åÿØÿ±ÿ®Ÿàÿ±ÿØ', 'ÿßÿ≥ÿ™ÿ±€å⁄© ÿ®ÿßŸÑÿß', 'VIP Ÿà€å⁄òŸá', 'ÿß€åŸàŸÜÿ™ ŸÖÿ≠ÿØŸàÿØ', 'Ÿæÿ±ÿ≥ÿ™€å⁄ò'
        ];

        specialNames.forEach((name, idx) => { if (frames[idx]) frames[idx].name = name; });

        // ÿØÿßÿØŸá‚ÄåŸáÿß€å ⁄©ÿßÿ±ÿ®ÿ±
        let userData = {
            name: '⁄©ÿßÿ±ÿ®ÿ±',
            coins: 5000,
            ownedFrames: [1],
            currentFrame: 1,
            wins: 0,
            level: 1,
            streak: 0,
            gameStats: { playerScore: 0, botScore: 0 }
        };

        let currentMode = 'easy';
        let onlineMode = 'easy';
        let choicesOpen = false;
        let guideOpen = false;
        let onlineChoicesOpen = false;
        let currentRoom = null;
        let playerId = Math.random().toString(36).substring(7);
        let pollInterval = null;

        function initTelegram() {
            if (window.Telegram && Telegram.WebApp) {
                Telegram.WebApp.expand();
                const user = Telegram.WebApp.initDataUnsafe?.user;
                if (user) {
                    userData.name = user.first_name + (user.last_name ? ' ' + user.last_name : '');
                    if (user.photo_url) {
                        document.getElementById('avatarImg').innerHTML = `<img src="${user.photo_url}" style="width:100%;height:100%;object-fit:cover;">`;
                    }
                }
            }
            loadUserData();
            showSection('bot');
        }

        function loadUserData() {
            const saved = localStorage.getItem('arena_data');
            if (saved) {
                try {
                    userData = { ...userData, ...JSON.parse(saved) };
                } catch (e) {}
            }
            updateAllDisplays();
        }

        function saveUserData() {
            localStorage.setItem('arena_data', JSON.stringify(userData));
        }

        function updateAllDisplays() {
            document.getElementById('userName').innerHTML = userData.name;
            document.getElementById('userWins').innerHTML = userData.wins;
            document.getElementById('userLevel').innerHTML = userData.level;
            document.getElementById('userCoins').innerHTML = `üí∞ ${userData.coins}`;
            document.getElementById('playerScore').innerHTML = userData.gameStats.playerScore;
            document.getElementById('botScore').innerHTML = userData.gameStats.botScore;
            document.getElementById('streakDisplay').innerHTML = userData.streak;
            
            const frame = frames.find(f => f.id === userData.currentFrame);
            if (frame) {
                document.getElementById('avatarFrame').className = `avatar-frame ${frame.class}`;
            }
            
            renderShop();
            renderChoices();
            renderOnlineChoices();
            renderGuide();
        }

        function showSection(section) {
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.game-section, .shop-section').forEach(el => el.classList.remove('active'));
            
            if (section === 'bot') {
                document.querySelectorAll('.nav-btn')[0].classList.add('active');
                document.getElementById('botSection').classList.add('active');
            } else if (section === 'online') {
                document.querySelectorAll('.nav-btn')[1].classList.add('active');
                document.getElementById('onlineSection').classList.add('active');
            } else if (section === 'shop') {
                document.getElementById('shopSection').classList.add('active');
            }
        }

        function toggleTheme() {
            const current = document.body.getAttribute('data-theme');
            const newTheme = current === 'dark' ? 'light' : 'dark';
            document.body.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            document.getElementById('themeKnob').classList.toggle('dark', newTheme === 'dark');
        }

        function setGameMode(mode) {
            currentMode = mode;
            document.querySelectorAll('#botSection .mode-option').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('advancedGuideBtn').style.display = mode === 'advanced' ? 'block' : 'none';
            if (mode !== 'advanced') closeGuide();
            renderChoices();
            closeChoices();
        }

        function setOnlineMode(mode) {
            onlineMode = mode;
            document.querySelectorAll('#onlineSection .mode-option').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderOnlineChoices();
        }

        function toggleChoices() {
            choicesOpen = !choicesOpen;
            const wrapper = document.getElementById('choicesWrapper');
            const arrows = document.querySelectorAll('#botSection .arrow-icon');
            wrapper.classList.toggle('open', choicesOpen);
            arrows.forEach(arrow => arrow.style.transform = choicesOpen ? 'rotate(180deg)' : 'rotate(0deg)');
            document.getElementById('btnText').innerHTML = choicesOpen ? 'ÿ®ÿ≥ÿ™ŸÜ ŸÖŸÜŸà' : 'ÿπŸÜÿßÿµÿ± ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ';
        }

        function closeChoices() {
            if (choicesOpen) toggleChoices();
        }

        function renderChoices() {
            const grid = document.getElementById('choicesGrid');
            grid.innerHTML = elements[currentMode].map((el, i) => `
                <div class="choice-item" onclick="selectChoice('${el.name}', '${el.emoji}')" style="animation-delay: ${i*0.1}s">
                    <span class="choice-emoji">${el.emoji}</span>
                    <span class="choice-name">${el.name}</span>
                </div>
            `).join('');
        }

        function selectChoice(playerChoice, playerEmoji) {
            if (navigator.vibrate) navigator.vibrate(50);
            document.getElementById('playerChoice').innerHTML = playerEmoji;
            
            const botElement = elements[currentMode][Math.floor(Math.random() * elements[currentMode].length)];
            document.getElementById('botChoice').innerHTML = botElement.emoji;
            
            const result = determineWinner(playerChoice, botElement.name, currentMode);
            const resultDiv = document.getElementById('resultMessage');
            
            if (result === 'ÿ®ÿ±ÿØ') {
                resultDiv.innerHTML = 'üèÜ ÿ®ÿ±ÿØ€å! +€±€∞ ÿ≥⁄©Ÿá';
                userData.gameStats.playerScore++;
                userData.wins++;
                userData.coins += 10;
                userData.streak++;
                userData.level = Math.floor(userData.wins / 10) + 1;
                if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
            } else if (result === 'ÿ®ÿßÿÆÿ™') {
                resultDiv.innerHTML = 'üíî ÿ®ÿßÿÆÿ™€å!';
                userData.gameStats.botScore++;
                userData.streak = 0;
                if (navigator.vibrate) navigator.vibrate(200);
            } else {
                resultDiv.innerHTML = 'ü§ù ŸÖÿ≥ÿßŸà€å!';
                userData.streak = 0;
                if (navigator.vibrate) navigator.vibrate(30);
            }
            
            saveUserData();
            updateAllDisplays();
            setTimeout(() => closeChoices(), 300);
        }

        function determineWinner(player, opponent, mode) {
            if (player === opponent) return 'ŸÖÿ≥ÿßŸà€å';
            if (mode === 'easy') {
                if (player === 'ÿ≥ŸÜ⁄Ø' && opponent === 'ŸÇ€å⁄Ü€å') return 'ÿ®ÿ±ÿØ';
                if (player === '⁄©ÿßÿ∫ÿ∞' && opponent === 'ÿ≥ŸÜ⁄Ø') return 'ÿ®ÿ±ÿØ';
                if (player === 'ŸÇ€å⁄Ü€å' && opponent === '⁄©ÿßÿ∫ÿ∞') return 'ÿ®ÿ±ÿØ';
                return 'ÿ®ÿßÿÆÿ™';
            } else {
                const rule = advancedRules[player];
                if (rule.wins.includes(opponent)) return 'ÿ®ÿ±ÿØ';
                if (rule.loses.includes(opponent)) return 'ÿ®ÿßÿÆÿ™';
                return 'ŸÖÿ≥ÿßŸà€å';
            }
        }

        function toggleGuide() {
            guideOpen = !guideOpen;
            document.getElementById('guideWrapper').classList.toggle('open', guideOpen);
            document.getElementById('guideArrow').style.transform = guideOpen ? 'rotate(180deg)' : 'rotate(0deg)';
        }

        function closeGuide() {
            if (guideOpen) toggleGuide();
        }

        function renderGuide() {
            const grid = document.getElementById('guideGrid');
            grid.innerHTML = Object.keys(advancedRules).map(el => {
                const rule = advancedRules[el];
                const emoji = getEmoji(el);
                return `
                    <div class="guide-item" onclick="this.classList.toggle('active')">
                        <div class="guide-header"><span>${emoji}</span><span>${el}</span></div>
                        <div class="guide-details">
                            <div class="guide-wins">‚úÖ ${rule.wins.map(w => getEmoji(w)).join(' ')}</div>
                            <div class="guide-loses">‚ùå ${rule.loses.map(l => getEmoji(l)).join(' ')}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getEmoji(name) {
            const map = {
                '⁄Øÿ±⁄Ø':'üê∫', 'ÿØÿ±ÿÆÿ™':'üå≥', 'ÿßŸÜÿ≥ÿßŸÜ':'üë§', 'ŸÖÿßÿ±':'üêç', 'ŸÇ€å⁄Ü€å':'‚úÇÔ∏è',
                'ÿ¢ÿ™ÿ¥':'üî•', 'ÿ≥ŸÜ⁄Ø':'ü™®', 'ÿ™ŸÅŸÜ⁄Ø':'üî´', 'ÿµÿßÿπŸÇŸá':'‚ö°', 'ÿ¥€åÿ∑ÿßŸÜ':'üòà',
                'ÿß⁄òÿØŸáÿß':'üêâ', 'ÿ¢ÿ®':'üíß', 'ÿ®ÿßÿØ':'üå™Ô∏è', '⁄©ÿßÿ∫ÿ∞':'üìÑ', 'ÿßÿ≥ŸÅŸÜÿ¨':'üßΩ'
            };
            return map[name] || '‚ùì';
        }

        function toggleOnlineChoices() {
            onlineChoicesOpen = !onlineChoicesOpen;
            document.getElementById('onlineChoicesWrapper').classList.toggle('open', onlineChoicesOpen);
            document.getElementById('onlineArrowIcon').style.transform = onlineChoicesOpen ? 'rotate(180deg)' : 'rotate(0deg)';
            document.getElementById('onlineBtnText').innerHTML = onlineChoicesOpen ? 'ÿ®ÿ≥ÿ™ŸÜ ŸÖŸÜŸà' : 'ÿπŸÜÿßÿµÿ± ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ';
        }

        function renderOnlineChoices() {
            const grid = document.getElementById('onlineChoicesGrid');
            grid.innerHTML = elements[onlineMode].map((el, i) => `
                <div class="choice-item" onclick="selectOnlineChoice('${el.name}', '${el.emoji}')" style="animation-delay: ${i*0.1}s">
                    <span class="choice-emoji">${el.emoji}</span>
                    <span class="choice-name">${el.name}</span>
                </div>
            `).join('');
        }

        function createRoom() {
            const roomId = Math.random().toString(36).substring(2, 8).toUpperCase();
            document.getElementById('roomId').value = roomId;
            currentRoom = roomId;
            localStorage.setItem(`game_${roomId}`, JSON.stringify({
                room: roomId, players: { [playerId]: { name: userData.name } }, choices: {}, mode: onlineMode
            }));
            document.getElementById('onlineGameArea').style.display = 'block';
            document.getElementById('waitingLoader').style.display = 'flex';
            startPolling(roomId);
        }

        function joinRoom() {
            const roomId = document.getElementById('roomId').value.toUpperCase();
            if (!roomId) return alert('⁄©ÿØ ÿßÿ™ÿßŸÇ ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ!');
            const saved = localStorage.getItem(`game_${roomId}`);
            if (!saved) return alert('ÿßÿ™ÿßŸÇ Ÿàÿ¨ŸàÿØ ŸÜÿØÿßÿ±ÿØ!');
            
            currentRoom = roomId;
            const state = JSON.parse(saved);
            if (Object.keys(state.players).length >= 2) return alert('ÿßÿ™ÿßŸÇ Ÿæÿ± ÿßÿ≥ÿ™!');
            
            state.players[playerId] = { name: userData.name };
            localStorage.setItem(`game_${roomId}`, JSON.stringify(state));
            document.getElementById('onlineGameArea').style.display = 'block';
            document.getElementById('waitingLoader').style.display = 'none';
            startPolling(roomId);
        }

        function startPolling(roomId) {
            if (pollInterval) clearInterval(pollInterval);
            pollInterval = setInterval(() => {
                if (!currentRoom) return;
                const saved = localStorage.getItem(`game_${currentRoom}`);
                if (!saved) return;
                
                const state = JSON.parse(saved);
                if (state.choices?.[playerId]) {
                    const el = elements[state.mode || 'easy'].find(e => e.name === state.choices[playerId]);
                    if (el) document.getElementById('onlinePlayerChoice').innerHTML = el.emoji;
                }
                
                const opponentId = Object.keys(state.players || {}).find(id => id !== playerId);
                if (opponentId && state.choices?.[opponentId]) {
                    document.getElementById('waitingLoader').style.display = 'none';
                    const el = elements[state.mode || 'easy'].find(e => e.name === state.choices[opponentId]);
                    if (el) {
                        document.getElementById('onlineOpponentChoice').innerHTML = el.emoji;
                        if (state.choices[playerId]) {
                            const res = determineWinner(state.choices[playerId], state.choices[opponentId], state.mode || 'easy');
                            document.getElementById('onlineResult').innerHTML = 
                                res === 'ÿ®ÿ±ÿØ' ? 'üèÜ ÿ¥ŸÖÿß ÿ®ÿ±ŸÜÿØŸá ÿ¥ÿØ€åÿØ!' : res === 'ÿ®ÿßÿÆÿ™' ? 'üíî ÿ≠ÿ±€åŸÅ ÿ®ÿ±ŸÜÿØŸá ÿ¥ÿØ!' : 'ü§ù ŸÖÿ≥ÿßŸà€å!';
                        }
                    }
                } else {
                    document.getElementById('onlineOpponentChoice').innerHTML = '‚ùì';
                    if (Object.keys(state.players).length < 2) {
                        document.getElementById('waitingLoader').style.display = 'flex';
                        document.getElementById('onlineResult').innerHTML = 'ŸÖŸÜÿ™ÿ∏ÿ± ÿ≠ÿ±€åŸÅ...';
                    }
                }
            }, 1000);
        }

        function selectOnlineChoice(choice, emoji) {
            if (!currentRoom) return alert('Ÿàÿßÿ±ÿØ ÿßÿ™ÿßŸÇ ÿ¥Ÿà€åÿØ!');
            document.getElementById('onlinePlayerChoice').innerHTML = emoji;
            const saved = localStorage.getItem(`game_${currentRoom}`);
            if (saved) {
                const state = JSON.parse(saved);
                state.choices = state.choices || {};
                state.choices[playerId] = choice;
                localStorage.setItem(`game_${currentRoom}`, JSON.stringify(state));
            }
            if (onlineChoicesOpen) toggleOnlineChoices();
        }

        function leaveRoom() {
            if (currentRoom) {
                const saved = localStorage.getItem(`game_${currentRoom}`);
                if (saved) {
                    const state = JSON.parse(saved);
                    delete state.players[playerId];
                    if (state.choices) delete state.choices[playerId];
                    if (Object.keys(state.players).length === 0) localStorage.removeItem(`game_${currentRoom}`);
                    else localStorage.setItem(`game_${currentRoom}`, JSON.stringify(state));
                }
            }
            if (pollInterval) clearInterval(pollInterval);
            currentRoom = null;
            document.getElementById('onlineGameArea').style.display = 'none';
        }

        function renderShop() {
            document.getElementById('framesList').innerHTML = frames.map(frame => {
                const isOwned = userData.ownedFrames.includes(frame.id);
                const canBuy = userData.coins >= frame.price && !isOwned;
                return `
                    <div class="frame-item">
                        <div class="frame-preview">
                            <div class="preview-frame ${frame.class}"></div>
                            <div class="preview-avatar">${frame.id}</div>
                        </div>
                        <div class="frame-info">
                            <div class="frame-name">${frame.name}</div>
                            <div class="frame-price">üí∞ ${frame.price}</div>
                        </div>
                        ${isOwned ? 
                            `<button class="buy-btn owned" onclick="selectFrame(${frame.id})" ${userData.currentFrame === frame.id ? 'disabled' : ''}>
                                ${userData.currentFrame === frame.id ? 'ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá' : 'ÿßŸÜÿ™ÿÆÿßÿ®'}
                            </button>` : 
                            `<button class="buy-btn" onclick="buyFrame(${frame.id})" ${!canBuy ? 'disabled' : ''}>
                                ${canBuy ? 'ÿÆÿ±€åÿØ' : 'ŸÜÿØÿßÿ±€å'}
                            </button>`
                        }
                    </div>
                `;
            }).join('');
        }

        function buyFrame(id) {
            const frame = frames.find(f => f.id === id);
            if (userData.coins >= frame.price) {
                userData.coins -= frame.price;
                userData.ownedFrames.push(id);
                saveUserData();
                updateAllDisplays();
            }
        }

        function selectFrame(id) {
            userData.currentFrame = id;
            saveUserData();
            updateAllDisplays();
        }

        // ŸÖŸÇÿØÿßÿ±ÿØŸá€å ÿßŸàŸÑ€åŸá
        window.onload = function() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.body.setAttribute('data-theme', savedTheme);
            document.getElementById('themeKnob').classList.toggle('dark', savedTheme === 'dark');
            initTelegram();
        };
    </script>
</body>
</html>
